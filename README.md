# ğŸï¸ Nostr Moto Log

ãƒã‚¤ã‚¯ã®çµ¦æ²¹ãƒ»æ•´å‚™ãƒ»ç‚¹æ¤œã‚’ [Nostr](https://nostr.com/) ã«è¨˜éŒ²ã™ã‚‹ PWA ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€‚

ãƒ‡ãƒ¼ã‚¿ã¯ Nostr ãƒªãƒ¬ãƒ¼ã« **kind 30078 (Parameterized Replaceable Event)** ã¨ã—ã¦ä¿å­˜ã•ã‚Œã‚‹ãŸã‚ã€ç‰¹å®šã®ã‚µãƒ¼ãƒãƒ¼ã«ä¾å­˜ã›ãšã€ã©ã“ã‹ã‚‰ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

## ä¸»ãªæ©Ÿèƒ½

| ã‚«ãƒ†ã‚´ãƒª              | æ©Ÿèƒ½                                                                                  |
| --------------------- | ------------------------------------------------------------------------------------- |
| â›½ **çµ¦æ²¹**           | çµ¦æ²¹é‡ãƒ»é‡‘é¡ãƒ»ODOãƒ»ã‚¹ã‚¿ãƒ³ãƒ‰ã‚’è¨˜éŒ²ã€‚ã€Œæº€ã‚¿ãƒ³ã«ã—ãŸï¼ã€ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—è¨˜éŒ²ã«ã‚‚å¯¾å¿œ           |
| ğŸ”§ **ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—æ•´å‚™** | ç©ºæ°—åœ§ãƒ»ãƒã‚§ãƒ¼ãƒ³æ³¨æ²¹/æ¸…æƒ/èª¿æ•´ãƒ»æ´—è»Šãƒ»ã‚ªã‚¤ãƒ«ç¢ºèª ç­‰ã‚’ã‚¿ãƒƒãƒ—ã ã‘ã§å³è¨˜éŒ²               |
| ğŸ“‹ **ç‚¹æ¤œ**           | æ—¥å¸¸/é€±é–“/æœˆé–“ç‚¹æ¤œã€‚é …ç›®ã”ã¨ã® OK/NG åˆ¤å®šã¨ ALL OK ç‡ã®è¿½è·¡                           |
| ğŸ­ **ã‚·ãƒ§ãƒƒãƒ—æ•´å‚™**   | ãƒã‚¤ã‚¯å±‹ã§ã®ä½œæ¥­å†…å®¹ãƒ»è²»ç”¨ãƒ»æ¬¡å›äºˆå®šã‚’è¨˜éŒ²                                            |
| ğŸ“Š **çµ±è¨ˆ**           | ç‡ƒè²»æ¨ç§»ã€ã‚¬ã‚½ãƒªãƒ³å˜ä¾¡æ¨ç§»ã€æœˆåˆ¥ã‚³ã‚¹ãƒˆ (ç‡ƒæ–™/æ•´å‚™)ã€æ•´å‚™å›æ•°ã€ç‚¹æ¤œ OK ç‡              |
| ğŸ  **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** | æœ€çµ‚ãƒ¡ãƒ³ãƒ†ä¸€è¦§ (è‰²åˆ†ã‘è­¦å‘Š)ã€æ¬¡å›äºˆå®šãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã€ç›´è¿‘ã®è¨˜éŒ²                         |
| ğŸ“‹ **å±¥æ­´**           | ã‚¿ãƒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ (å…¨ã¦/çµ¦æ²¹/æ•´å‚™/ç‚¹æ¤œ/ã‚·ãƒ§ãƒƒãƒ—)ã€æœˆåˆ¥ã‚°ãƒ«ãƒ¼ãƒ—è¡¨ç¤ºã€ãƒªãƒƒãƒã‚«ãƒ¼ãƒ‰         |
| ğŸš— **è¤‡æ•°è»Šä¸¡**       | 2å°æŒã¡OKã€‚è¨­å®šç”»é¢ã‹ã‚‰ãƒã‚¤ã‚¯ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»åˆ‡ã‚Šæ›¿ãˆãŒå¯èƒ½ã€‚è»Šä¸¡ã”ã¨ã«è¨˜éŒ²ãƒ»çµ±è¨ˆã‚’ç®¡ç† |

## ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

> TODO: ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’è¿½åŠ 

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: [SvelteKit](https://svelte.dev/) (Svelte 5 / Runes)
- **Nostr**: [rx-nostr](https://github.com/penpenpng/rx-nostr) + [nostr-tools](https://github.com/nbd-wtf/nostr-tools)
- **èªè¨¼**: [@konemono/nostr-login](https://github.com/nicoschmdt/nostr-login) (NIP-07 / NIP-46)
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: [Tailwind CSS 4](https://tailwindcss.com/)
- **ãƒ“ãƒ«ãƒ‰**: [Vite](https://vite.dev/)

## Nostr ã‚¤ãƒ™ãƒ³ãƒˆè¨­è¨ˆ

ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¯ **kind 30078** ã® Parameterized Replaceable Event ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚

```
d-tag å½¢å¼: {recordType}:{vehicleId}:{unixTimestamp}
```

| ãƒ¬ã‚³ãƒ¼ãƒ‰ç¨®åˆ¥ | d-tag ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹          | å†…å®¹                 |
| ------------ | ----------------------------- | -------------------- |
| è»Šä¸¡æƒ…å ±     | `vehicle:{id}`                | è»Šä¸¡ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«     |
| çµ¦æ²¹         | `refuel:{vehicleId}:{ts}`     | çµ¦æ²¹é‡ãƒ»é‡‘é¡ãƒ»ODO ç­‰ |
| ã‚¯ã‚¤ãƒƒã‚¯æ•´å‚™ | `quick:{vehicleId}:{ts}`      | ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—æ•´å‚™è¨˜éŒ²   |
| ç‚¹æ¤œ         | `inspection:{vehicleId}:{ts}` | ç‚¹æ¤œçµæœ             |
| ã‚·ãƒ§ãƒƒãƒ—æ•´å‚™ | `shop:{vehicleId}:{ts}`       | ä½œæ¥­å†…å®¹ãƒ»è²»ç”¨       |
| èµ°è¡Œè·é›¢     | `odo:{vehicleId}:{ts}`        | ã‚ªãƒ‰ãƒ¡ãƒ¼ã‚¿ãƒ¼è¨˜éŒ²     |

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```sh
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/htm43/nostr-moto-log.git
cd nostr-moto-log

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
npm run dev
```

## é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

```sh
npm run dev          # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run build        # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
npm run preview      # ãƒ“ãƒ«ãƒ‰çµæœã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
npm run check        # å‹ãƒã‚§ãƒƒã‚¯ (svelte-check)
```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
src/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ components/Toast.svelte  # ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥
â”‚   â”œâ”€â”€ constants.ts             # å…±é€šå®šæ•°ãƒ»ãƒ©ãƒ™ãƒ«
â”‚   â”œâ”€â”€ models/types.ts          # ãƒ‡ãƒ¼ã‚¿å‹å®šç¾©
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”œâ”€â”€ app.svelte.ts        # ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç† (Svelte 5 Runes)
â”‚   â”‚   â””â”€â”€ toast.svelte.ts      # ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚¹ãƒˆã‚¢
â”‚   â”œâ”€â”€ nostr/
â”‚   â”‚   â”œâ”€â”€ client.ts            # rx-nostr ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ publish.ts           # ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
â”‚   â”‚   â””â”€â”€ subscribe.ts         # ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­ãƒ»ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ fuel-calc.ts         # ç‡ƒè²»è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ +layout.svelte           # å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ (èªè¨¼ãƒ»ãƒŠãƒ“ãƒ»ãƒˆãƒ¼ã‚¹ãƒˆ)
â”‚   â”œâ”€â”€ +page.svelte             # ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
â”‚   â”œâ”€â”€ home/                    # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ log/                     # è¨˜éŒ²å…¥åŠ› (çµ¦æ²¹ãƒ»ç‚¹æ¤œãƒ»ã‚·ãƒ§ãƒƒãƒ—)
â”‚   â”œâ”€â”€ history/                 # å±¥æ­´ä¸€è¦§
â”‚   â”œâ”€â”€ stats/                   # çµ±è¨ˆ
â”‚   â”œâ”€â”€ edit/                    # è¨˜éŒ²ç·¨é›†
â”‚   â”œâ”€â”€ settings/                # è¨­å®š
â”‚   â””â”€â”€ vehicle/                 # è»Šä¸¡ç™»éŒ²
â”œâ”€â”€ service-worker.ts            # PWA Service Worker
â””â”€â”€ app.css                      # Tailwind CSS + ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ
```

## ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒªãƒ¬ãƒ¼

- `wss://relay.damus.io`
- `wss://nos.lol`
- `wss://relay.nostr.wirednet.jp`

è¨­å®šç”»é¢ã‹ã‚‰ãƒªãƒ¬ãƒ¼ã®è¿½åŠ ãƒ»å‰Šé™¤ãŒå¯èƒ½ã§ã™ï¼ˆäºˆå®šï¼‰ã€‚æ¥ç¶šçŠ¶æ…‹ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèªã§ãã¾ã™ã€‚

## âš ï¸ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã«é–¢ã™ã‚‹æ³¨æ„

Nostr ã«ä¿å­˜ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯**å…¬é–‹æƒ…å ±**ã§ã™ã€‚ä»¥ä¸‹ã®æƒ…å ±ã¯å…¥åŠ›ã—ãªã„ã§ãã ã•ã„ï¼š

- ğŸš¨ ãƒŠãƒ³ãƒãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆç•ªå·
- ğŸš¨ è‡ªå®…è¿‘ãã®ã‚¬ã‚½ãƒªãƒ³ã‚¹ã‚¿ãƒ³ãƒ‰å
- ğŸš¨ ãƒã‚¤ã‚¯å±‹ã®å…·ä½“çš„ãªåº—èˆ—å
- ğŸš¨ å€‹äººæƒ…å ± (åå‰ãƒ»ä½æ‰€ãƒ»é›»è©±ç•ªå·)

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
