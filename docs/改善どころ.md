# 改善どころ

実際に使ってみた場合を想定して、現状の問題点と改善案をまとめる。

---

## 1. 履歴ページが全部ごちゃまぜ問題 (最優先)

### 現状

- 履歴が全種類ごちゃまぜの1本タイムラインしかない
- 「前回チェーン注油いつだっけ？」がすぐわからない
- 給油だけ見たい、整備だけ見たい、ができない
- 記録が増えるほど目的の記録を探すのが大変

### 改善案

- **タブ or フィルターチップで種類別表示**
  - `全て` `⛽ 給油` `🔧 整備` `📋 点検` `🏭 ショップ` のタブを上部に
  - 選択中のタブだけフィルタして表示
- **整備 (quick) はさらにサブフィルタ**
  - 「チェーン系だけ」「空気圧だけ」で絞れると「前回いつやったか」が一瞬でわかる
- **月別グルーピング**
  - 今は日付がずらっと並ぶだけ → `2026年2月` `2026年1月` のように月ヘッダーで区切る
  - 月ごとに何回給油して合計いくら使ったか、みたいなサマリーも出せると良い

---

## 2. 「前回○○してからどれくらい経った？」がわからない

### 現状

- チェーン注油、オイル交換、空気圧チェックなどの「最終実施日」が一目でわからない
- わざわざ履歴をスクロールして探す必要がある

### 改善案

- **ホーム画面に「最終メンテ一覧」カードを追加**
  ```
  🔗 チェーン注油   3日前 (2/12)
  💨 空気圧チェック  12日前 (2/3)  ← 色が黄色 (しばらくやってない)
  🚿 洗車           21日前 (1/25) ← 色が赤 (やばい)
  🛢 オイル交換     45日前 (1/1)  ← ショップ記録からも引っ張る
  ```
- **経過日数で色分け** (自分で閾値を設定できるとベスト)
  - 緑: 最近やった / 黄: そろそろ / 赤: やばい
- ホーム画面からタップでそのまま記録に飛べる動線

---

## 3. 統計ページが給油しか見えない

### 現状

- 統計ページは燃費・ガソリン代・走行距離のみ
- 点検やクイック整備の統計が一切ない
- 「今月何回整備した？」「年間で何にいくら使った？」がわからない

### 改善案

- **整備タイプ別の実施回数サマリー**
  ```
  📊 今月の整備
  チェーン注油: 3回  |  空気圧: 2回  |  洗車: 1回
  ```
- **ショップ整備コスト集計**
  - 月別/年別の整備費用グラフ (給油代と合わせてトータルコストも)
  - 「オイル交換に年間いくら使ったか」みたいな作業別集計
- **点検の ALL OK 率**
  - 直近10回の点検で何%が ALL OK だったか

---

## 4. 給油記録の詳細が一覧で見づらい

### 現状

- 履歴で給油は `給油 10.5L ¥1,838 (5,200 km)` の1行だけ
- レシートの写真を貼れない (Nostrの制約上仕方ないかも)
- 給油間の走行距離がわからない (「前回から何km走って給油したのか」)

### 改善案

- **給油履歴の専用ビュー (タブ切替で)**
  - 各給油の「前回からの走行距離」「この区間の燃費」を表示
  - 単価のトレンド (最近ガソリン高くなってるなぁ、がわかる)
- **ガソリン単価の推移グラフ** (stats ページに)
  - 自分のデータからガソリン単価がどう変化しているかが見える

---

## 5. ショップ整備の次回予定が活かされてない

### 現状

- ShopRecord に `nextDate` `nextOdometer` があるが、どこにも表示されてない
- せっかく入力しても忘れる

### 改善案

- **ホーム画面に「次回メンテナンスリマインダー」**
  ```
  ⏰ 予定
  オイル交換: 2026/03/15 (あと28日)
  次回 ODO: 10,000km (あと 1,200km)
  ```
- 期限が近づいたら色を変える (黄色→赤)
- ショップ記録だけでなく、自分で任意のリマインダーを設定できても良い

---

## 6. UX の細かい改善

### 6-1. 記録直後の導線

- 給油記録後にホームに戻るが、「記録しました！」のフィードバックがない (quickにはトーストあるが給油にはない)
- 記録後に「続けて記録する？」的な選択肢があっても良い

### 6-2. ワンタップ整備に ODO 入力

- クイック整備にも ODO を入力できると走行距離管理が細かくできる
- 今はクイックボタン → 即保存だが、「ODO 入れる？」をオプショナルに聞いてもいい

### 6-3. よく使うスタンド・前回情報の自動入力

- 給油フォームで前回のスタンド名・単価を自動で入れてくれると楽
- `pricePerLiter` は placeholder に前回値があるが、実際に自動入力 (prefill) してくれた方が便利

### 6-4. 満タンボタンにも ODO 入力欄

- 現状「満タンにした！」ボタンは日付と ODO が紐づくが、ODO の入力は画面下部の折りたたみ内
- ワンタップボタンの直下に「ODO もついでに入力する？」的な小さい入力欄があると良い
  - ただし「面倒にしない」が最重要なので、あくまでオプショナル

---

## 7. データの安全性・信頼性

### 7-1. オフライン対応

- 現状 Nostr に publish できないと記録が消える (ローカルストアはあるが永続化されてない)
- Service Worker + IndexedDB でオフラインキャッシュ → 復帰後に sync

### 7-2. 複数車両の切り替え UI

- `vehicleStore.activeVehicleId` で切り替える仕組みはあるが、UIに切り替えボタンがない
- 2台持ちの人は今のままだと不便

### 7-3. データインポート

- エクスポートはあるがインポートがない
- JSON ファイルからの復元機能

---

## 8. 記録種別ごとの表示改善 (詳細)

### 給油

| 今の表示                       | 改善後のイメージ                                                            |
| ------------------------------ | --------------------------------------------------------------------------- |
| `給油 10.5L ¥1,838 (5,200 km)` | 給油 10.5L (満タン)<br>¥1,838 (@175円/L)<br>前回から 230km / 燃費 21.9 km/L |

→ 1行じゃなくてカードUIにすれば情報量を増やせる

### クイック整備

| 今の表示         | 改善後のイメージ               |
| ---------------- | ------------------------------ |
| `空気圧チェック` | 空気圧チェック<br>前回から12日 |

→ 前回からの経過日数があるだけで「サボってないか」がわかる

### ショップ整備

| 今の表示                       | 改善後のイメージ                                                                                   |
| ------------------------------ | -------------------------------------------------------------------------------------------------- |
| `ショップ整備 (3項目) ¥15,000` | ショップ整備 @レッドバロン<br>オイル交換 / フィルタ交換 / チェーン調整<br>¥15,000 · 次回予定: 3/15 |

→ 作業内容が見えないのがもったいない

---

## 9. そもそも足りてない記録項目

- **カスタム整備メモ**: 決まったカテゴリに当てはまらない作業 (例: グリップ交換、スクリーン交換) を自由テキストで記録
- **パーツ交換記録**: 何を何km / いつ交換したか。次回交換の目安を設定
  - これがあると「ブレーキパッドあと何km で交換か」がわかる
- **タイヤレコード**: 銘柄・サイズ・交換日・走行距離 → 寿命の予測
- **写真添付**: Nostr に画像 URL として上げれば可能 (NIP-94 など)
  - ODO メーターの写真、レシート、外観記録

---

## 10. 実装優先度の提案

| 優先度 | 項目                              | 理由                                                     |
| ------ | --------------------------------- | -------------------------------------------------------- |
| ★★★    | 履歴のタブフィルター (#1)         | 使い勝手への影響が最大。これがないと記録が増えるほど不便 |
| ★★★    | 最終メンテ一覧 (#2)               | 「前回いつやったか」はバイク乗りが一番知りたい情報       |
| ★★☆    | 履歴カード表示の情報量アップ (#8) | フィルタができた上でカード内の情報も充実させる           |
| ★★☆    | 次回予定リマインダー (#5)         | せっかくデータあるのに使われてないのはもったいない       |
| ★★☆    | 統計ページの給油以外対応 (#3)     | 整備コスト全体把握は長期利用で重要                       |
| ★☆☆    | ショップ整備のコスト年間集計 (#3) | ある程度データ溜まってから効いてくる                     |
| ★☆☆    | オフライン対応 (#7-1)             | ツーリング中に電波なくて記録できないのは地味に困る       |
| ★☆☆    | 複数車両切替UI (#7-2)             | 2台持ちの人じゃないと不要                                |

---

## 所感

一番デカいのは**履歴ページのフィルター**。今は全部ごちゃまぜだから「前回チェーン注油いつやったっけ」を調べるのに全部スクロールしないといけない。種類別タブが入るだけで使い勝手が劇的に変わる。

2番目は**ホーム画面に「各メンテの最終日」を出す**こと。バイクの整備で一番大事なのは「サボってないか」の確認で、それがホーム開いた瞬間にわかるのが理想。
